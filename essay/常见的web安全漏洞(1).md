## 常见的web安全漏洞
### 1.SQL注入攻击
攻击者在HTTP请求中注入恶意的SQL代码，服务器使用参数构建数据库SQL命令时，恶意SQL被一起构造，并在数据库中执行

用户登录，输入用户名 yujiansong，密码 ‘ or ‘1’=’1 ，如果此时使用参数构造的方式，就会出现
```
# password = '  'or '1' ='1  '
SELECT true_name, mobile
FROM user
WHERE true_name = 'yujiansong' AND password = '' OR '1' = '1';
#不管用户名和密码是什么内容，使查询出来的用户列表不为空。
```
#### 如何防范SQL注入攻击
```
Web端
有效性检验。
限制字符串输入的长度。 （防止缓冲区溢出攻击）
服务端
不用拼接SQL字符串。
如果过于复杂的SQL,可以使用 PDO, MYsqlli
有效性检验。(为什么服务端还要做有效性检验？第一准则，外部都是不可信的，防止攻击者绕过Web端请求)
过滤SQL需要的参数中的特殊字符。比如单引号、双引号。 (可以使用mysql_escape_string ， addslashes 等)
严格限制Web应用的数据库的操作权限
```

### 2.XSS攻击
跨站点脚本攻击，**指攻击者通过篡改网页，嵌入恶意脚本程序**，在用户浏览网页时，控制用户浏览器进行恶意操作的一种攻击方式。
```
跨站脚本攻击有可能造成以下影响:

利用虚假输入表单骗取用户个人信息。
利用脚本窃取用户的Cookie值，被害者在不知情的情况下，帮助攻击者发送恶意请求。
显示伪造的文章或图片。
```
XSS 的攻击方式可以大致细分为几种类型。
> 1.**反射型 XSS **一般是通过给别人**发送带有恶意脚本代码参数的 URL**，典型的例子就是给个链接让你点击，当链接被打开时，特有的恶意代码参数被 HTML 解析、执行。不过一些浏览器如Chrome其内置了一些XSS过滤器，可以防止大部分反射型XSS攻击
#### 如何防反射型XSS攻击
```
了防止出现非持久型 XSS 漏洞，需要确保这么几件事情：

Web 页面渲染的所有内容或者渲染的数据都必须来自于服务端。
尽量不要从 URL，document.referrer，document.forms 等这种 DOM API 中获取数据直接渲染。
尽量不要使用 eval, new Function()，document.write()，document.writeln()，window.setInterval()，window.setTimeout()，innerHTML，document.createElement() 等可执行字符串的方法。
如果做不到以上几点，也必须对涉及 DOM 渲染的方法传入的字符串参数做 escape 转义。
前端渲染的时候对任何的字段都需要做 escape 转义编码。
```

> 2.持久型 XSS（**存储型 XSS**）持久型 XSS 漏洞，一般存在于 Form 表单提交等交互功能，如文章留言，提交文本信息等，黑客利用的 XSS 漏洞，将内容经正常功能提交进入数据库持久保存，当前端页面获得后端从数据库中读出的注入代码时，恰好将其渲染执行。
#### 如何防范存储型XSS攻击
```
前端，服务端，同时需要字符串输入的长度限制。
前端，服务端，对用户输入的数据进行转义，将其中的”<”,”>”等特殊字符进行转义编码。(htmlspecialchars, htmlentitles， 像lavarel，yii这些框架底层默认似乎用htmlspecialchars进行过滤)
htmlpurifier 过滤器（在项目中用到过）
```

### 3.CSRF攻击
跨站点请求伪造，一般指攻击者通过它利用用户已登录的身份，在用户毫不知情的情况下，以用户的名义完成非法操作。
```
完成 CSRF 攻击必须要有三个条件：

用户已经登录了站点 A，并在本地记录了 cookie
在用户没有登出站点 A 的情况下（也就是 cookie 生效的情况下），访问了恶意攻击者提供的引诱危险站点 B (B 站点要求访问站点A)。
站点 A 没有做任何 CSRF 防御
```
#### 如何防范CSRF攻击
```
1.token机制。在请求中进行token验证，如果请求中没有token或者token内容不正确，
则认为CSRF攻击而拒绝该请求。
2. 验证码。通常情况下，验证码能够很好的遏制CSRF攻击，
但是很多情况下，出于用户体验考虑，验证码只能作为一种辅助手段，
而不是最主要的解决方案。
3. referer识别。在HTTP Header中有一个字段Referer，它记录了HTTP请求的来源地址。
如果Referer是其他网站，就有可能是CSRF攻击，则拒绝该请求。
但是，服务器并非都能取到Referer。
很多用户出于隐私保护的考虑，限制了Referer的发送。
在某些情况下，浏览器也不会发送Referer，例如HTTPS跳转到HTTP，
但是可以通过Referer Check来监控CSRF攻击的发生可能性
4.Laravel 下的CSRF防御：Laravel 会自动为用户的会话生成一个 CSRF「令牌」。该令牌用于验证经过身份验证的用户是否是向应用程序发出请求的用户。
当你在应用程序中定义 HTML 表单时，都应该在表单中包含一个隐藏的 CSRF令牌字段（使用辅助函数 csrf_field 生成），以便 CSRF 保护中间件可以验证该请求：
CSRF 白名单，如果你正在使用第三方应用，你会需要从 CSRF 的保护中排除，因为第三方应用并不会给你的路由发送 CSRF 令牌。
```

### 4.文件上传漏洞
文件上传漏洞，指的是用户上传一个可执行的脚本文件，并通过此脚本文件获得了执行服务端命令的能力。
#### 如何防范文件上传漏洞
```
1.文件上传的目录设置为不可执行。
2.判断文件类型,只允许上传可靠类型。
3.上传的文件需要进行重新命名，使攻击者无法猜想上传文件的访问路径，将极大地增加攻击成本，同时向shell.php.rar.ara这种文件，因为重命名而无法成功实施攻击。
4.限制上传文件的大小。
5.单独设置文件服务器的域名。
```

### 5(服务器上可能存在的的漏洞)
> 原因可能由于ssh免密码登陆引起
```
1.假设一个运维人员有线上服务器上的管理员账号或者经过sudo授权后的账号
2.他可以用其它服务器ssh登陆这台线上服务器的账号,
而且ssh有个可以设置免密码登陆的方法
（只有首次需要密码，
之后把当前服务器上的公钥放在线上服务器，就可以不需要密码登陆）
3.所以就会引起一些问题
4.避免方法，可以在线上服务器上删除所放公钥的位置
```